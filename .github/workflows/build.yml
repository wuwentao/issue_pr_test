name: Context testing
on: push

jobs:
  dump_contexts:
    runs-on: ubuntu-latest
    env:
      MY_NAME: "My Test Name"
    steps:
      - name: Dump GitHub context
        id: github_context_step
        run: echo '${{ toJSON(github) }}'
      - name: Dump job context
        run: echo '${{ toJSON(job) }}'
      - name: Dump steps context
        run: echo '${{ toJSON(steps) }}'
      - name: Dump runner context
        run: echo '${{ toJSON(runner) }}'
      - name: Dump strategy context
        run: echo '${{ toJSON(strategy) }}'
      - name: Dump matrix context
        run: echo '${{ toJSON(matrix) }}'
        
      - name: Set the value to env variable
        id: step_one
        run: |
          echo "action_state=yellow" >> $GITHUB_ENV
      - name: Use the value from env variable
        id: step_two
        run: |
          echo "${{ env.action_state }}" # This will output 'yellow'
          
      - name: set output
        id: set_output
        run: echo "::set-output name=action_fruit::strawberry"
        
      - name: set debug
        id: set_debug
        run: echo "::debug::Set the Octocat variable"
      
      - name: mask string
        id: mask_str
        run: echo "::add-mask::$MY_NAME"
        
      - name: waring msg
        id: warning_msg
        run: |
          echo '::warning:: This is a warning message, to demonstrate that commands are being processed.'
          echo '::warning:: This is a warning again, because stop-commands has been turned off.'
             
  job1_output:
    runs-on: ubuntu-latest
    # Map a step output to a job output
    outputs:
      output1: ${{ steps.step1.outputs.test }}
      output2: ${{ steps.step2.outputs.test }}
    steps:
      - id: step1
        run: echo "::set-output name=test::hello"
      - id: step2
        run: echo "::set-output name=test::world"
  
  job2_show_output:
    runs-on: ubuntu-latest
    needs: job1_output
    steps:
      - run: echo ${{needs.job1_output.outputs.output1}} ${{needs.job1_output.outputs.output2}}
        
